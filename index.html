<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Flappy Cockatiel</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: skyblue;
  }
  canvas {
    display: block;
    margin: auto;
    background: linear-gradient(#87CEEB, #fff);
  }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

canvas.width = 400;
canvas.height = 600;

let W = canvas.width;
let H = canvas.height;

let gravity = 0.4;
let flap = -7;
let pipes = [];
let frame = 0;
let score = 0;
let gameOver = false;

// Load cockatiel image
const cockatielImg = new Image();
cockatielImg.src = "IMG_3897.png"; // Must be in same folder as this HTML file

let bird = {
  x: 80,
  y: H / 2,
  w: 50,
  h: 50,
  vy: 0,
  angle: 0
};

document.addEventListener("keydown", () => {
  if (!gameOver) bird.vy = flap;
});
document.addEventListener("touchstart", () => {
  if (!gameOver) bird.vy = flap;
});

function resetGame() {
  pipes = [];
  frame = 0;
  score = 0;
  bird.y = H / 2;
  bird.vy = 0;
  gameOver = false;
}

function drawBird() {
  ctx.save();
  ctx.translate(bird.x, bird.y);
  ctx.rotate(bird.angle);
  ctx.drawImage(cockatielImg, -bird.w / 2, -bird.h / 2, bird.w, bird.h);
  ctx.restore();
}

function drawPipes() {
  ctx.fillStyle = "green";
  pipes.forEach(pipe => {
    ctx.fillRect(pipe.x, 0, pipe.w, pipe.top);
    ctx.fillRect(pipe.x, H - pipe.bottom, pipe.w, pipe.bottom);
  });
}

function update() {
  frame++;
  bird.vy += gravity;
  bird.y += bird.vy;
  bird.angle = Math.min(Math.PI / 4, bird.vy / 10);

  if (frame % 90 === 0) {
    let top = Math.random() * (H / 2);
    let gap = 150;
    pipes.push({
      x: W,
      w: 50,
      top: top,
      bottom: H - top - gap
    });
  }

  pipes.forEach(pipe => {
    pipe.x -= 2;
    if (
      bird.x + bird.w / 2 > pipe.x &&
      bird.x - bird.w / 2 < pipe.x + pipe.w &&
      (bird.y - bird.h / 2 < pipe.top ||
        bird.y + bird.h / 2 > H - pipe.bottom)
    ) {
      gameOver = true;
    }
  });

  pipes = pipes.filter(pipe => pipe.x + pipe.w > 0);

  if (bird.y + bird.h / 2 >= H || bird.y - bird.h / 2 <= 0) {
    gameOver = true;
  }

  if (!gameOver) score += 0.01;
}

function drawScore() {
  ctx.fillStyle = "black";
  ctx.font = "20px Arial";
  ctx.fillText("Score: " + Math.floor(score), 10, 25);
}

function loop() {
  ctx.clearRect(0, 0, W, H);
  drawPipes();
  drawBird();
  drawScore();

  if (!gameOver) {
    update();
    requestAnimationFrame(loop);
  } else {
    ctx.fillStyle = "red";
    ctx.font = "30px Arial";
    ctx.fillText("Game Over", W / 2 - 80, H / 2);
    ctx.font = "20px Arial";
    ctx.fillText("Press Space or Tap to Restart", W / 2 - 140, H / 2 + 30);
    document.addEventListener("keydown", resetGame, { once: true });
    document.addEventListener("touchstart", resetGame, { once: true });
  }
}

cockatielImg.onload = loop;
</script>
</body>
</html>
